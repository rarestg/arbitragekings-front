<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arbitrage Through the Ages: A Mad Libs Adventure</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@11.3.28/dist/framer-motion.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
    // Debug: Log when script starts executing
    console.log("Script started");

    const {useState, useEffect} = React;
    const {motion, AnimatePresence} = Motion;

    // Debug: Log after constants are defined
    console.log("Constants defined");

    const madLibsData = [
        {
            id: 'hiking',
            title: "Hayden's Hiking Hustle",
            background: 'https://images.unsplash.com/photo-1504280390367-361c6d9f38f4?w=1920',
            words: {
                VERB: ['arbitrage', 'flip'],
                ADJECTIVE: ['ultralight'],
                NOUN: ['hiking gear', 'tents'],
                IMPORT_COSTS: ['duties and shipping and taxes'],
                START_LOCATION: ['the States'],
                ORIGIN: ['American'],
                PRODUCT: ['cottage brand'],
                TRAVEL_METHOD: ['go to Innisfil'],
                SHIPPING_COST: ['20 bucks'],
                SHIPPING_METHOD: ['Canada Post'],
                SELLING_POINT: ['no tax no nothing'],
                END_LOCATION: ['Canada']
            }
        },
        {
            id: 'spice',
            title: "Dutch East India Company's Spice Spectacle",
            background: 'https://images.unsplash.com/photo-1524492412937-b28074a5d7da?w=1920',
            words: {
                VERB: ['monopolize', 'corner'],
                ADJECTIVE: ['exotic', 'rare'],
                NOUN: ['spices', 'commodities'],
                IMPORT_COSTS: ['tariffs and voyage fees'],
                START_LOCATION: ['the Orient'],
                ORIGIN: ['Indian'],
                PRODUCT: ['colonial'],
                TRAVEL_METHOD: ['sail'],
                SHIPPING_COST: ['minimal'],
                SHIPPING_METHOD: ['company fleet'],
                SELLING_POINT: ['exclusive access'],
                END_LOCATION: ['Europe']
            }
        },
        {
            id: 'tea',
            title: "Boston Tea Party's Harbor Hustle",
            background: 'https://images.unsplash.com/photo-1716615240766-4f9eff8b5fda?w=1920',
            words: {
                VERB: ['undercut', 'smuggle'],
                ADJECTIVE: ['British', 'taxed'],
                NOUN: ['tea', 'leaves'],
                IMPORT_COSTS: ['import duties and crown taxes'],
                START_LOCATION: ['England'],
                ORIGIN: ['East India Company'],
                PRODUCT: ['Ceylon'],
                TRAVEL_METHOD: ['ship'],
                SHIPPING_COST: ['duty-free'],
                SHIPPING_METHOD: ['midnight run'],
                SELLING_POINT: ['no stamps required'],
                END_LOCATION: ['the Colonies']
            }
        }
    ];

    // Debug: Log after madLibsData is defined
    console.log("madLibsData defined");

    const madLibTemplate = `I realized I have this unique way to [VERB] expensive [ADJECTIVE] [NOUN] because everybody pays [IMPORT_COSTS] to [END_LOCATION] for all of this [ORIGIN] [PRODUCT] stuff. I could just [TRAVEL_METHOD] with it and then ship it for [SHIPPING_COST] using [SHIPPING_METHOD] [SELLING_POINT] so I think I might be able to [VERB] [PRODUCT] from [START_LOCATION] in [END_LOCATION].`;
    const Button = ({onClick, children, selected}) => (
        <button
            onClick={onClick}
            className={`px-4 py-2 rounded w-full ${
                selected
                    ? 'bg-blue-600 text-white'
                    : 'bg-blue-100 text-blue-600 hover:bg-blue-200'
            } transition-colors duration-200`}
        >
            {children}
        </button>
    );

    const MadLibWord = ({word, filled}) => (
        <span className={`font-bold ${filled ? 'text-green-600' : 'text-blue-600'}`}>
            [{word}]
          </span>
    );

    const ArbitrageApp = () => {
        const [selectedLib, setSelectedLib] = useState(null);
        const [filledWords, setFilledWords] = useState({});

        useEffect(() => {
            if (selectedLib) {
                const newFilledWords = {};
                Object.keys(selectedLib.words).forEach(key => {
                    newFilledWords[key] = selectedLib.words[key][0];
                });
                setFilledWords(newFilledWords);
            } else {
                setFilledWords({});
            }
        }, [selectedLib]);

        const renderMadLib = () => {
            return madLibTemplate.split(/(\[[^\]]+\])/).map((part, index) => {
                const match = part.match(/\[([^\]]+)\]/);
                if (match) {
                    const word = match[1];
                    return (
                        <MadLibWord
                            key={index}
                            word={filledWords[word] || word}
                            filled={!!filledWords[word]}
                        />
                    );
                }
                return part;
            });
        };

        return (
            <div className="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative">
                <AnimatePresence>
                    {selectedLib && (
                        <motion.div
                            initial={{opacity: 0}}
                            animate={{opacity: 1}}
                            exit={{opacity: 0}}
                            transition={{duration: 0.5}}
                            style={{
                                backgroundImage: `url(${selectedLib.background})`,
                                backgroundSize: 'cover',
                                backgroundPosition: 'center',
                            }}
                            className="fixed inset-0 z-0"
                        />
                    )}
                </AnimatePresence>
                <div className="z-10 bg-white bg-opacity-90 p-6 rounded-lg shadow-xl max-w-2xl w-full">
                    <h1 className="text-2xl sm:text-3xl font-bold mb-6 text-center">
                        Arbitrage Through the Ages: A Mad Libs Adventure
                    </h1>
                    <div className="grid grid-cols-2 sm:grid-cols-4 gap-2 mb-6">
                        <Button onClick={() => setSelectedLib(null)} selected={!selectedLib}>
                            Reset
                        </Button>
                        {madLibsData.map(lib => (
                            <Button
                                key={lib.id}
                                onClick={() => setSelectedLib(lib)}
                                selected={selectedLib?.id === lib.id}
                            >
                                {lib.title}
                            </Button>
                        ))}
                    </div>
                    <p className="text-base sm:text-lg leading-relaxed mb-6">{renderMadLib()}</p>
                    {selectedLib && (
                        <div className="mt-6">
                            <h2 className="text-xl font-semibold mb-4">Word Choices:</h2>
                            <div className="grid grid-cols-2 sm:grid-cols-3 gap-4">
                                {Object.entries(selectedLib.words).map(([key, words]) => (
                                    <div key={key} className="mb-2">
                                        <span className="font-medium">{key}:</span>{' '}
                                        <div className="flex flex-wrap gap-1 mt-1">
                                            {words.map((word) => (
                                                <button
                                                    key={word}
                                                    onClick={() => setFilledWords(prev => ({...prev, [key]: word}))}
                                                    className={`px-2 py-1 rounded text-sm ${
                                                        filledWords[key] === word
                                                            ? 'bg-green-600 text-white'
                                                            : 'bg-green-100 text-green-600 hover:bg-green-200'
                                                    } transition-colors duration-200`}
                                                >
                                                    {word}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            </div>
        );
    };

    // Debug: Log after ArbitrageApp is defined
    console.log("ArbitrageApp defined");

    // Debug: Log before ReactDOM.render
    console.log("About to render");

    ReactDOM.render(<ArbitrageApp/>, document.getElementById('root'));

    // Debug: Log after ReactDOM.render
    console.log("Render complete");
</script>
</body>
</html>
